library(ggplot2)
# Load required libraries
library(readxl)
library(dplyr)
library(ggplot2)
# Load your Excel file
data <- read_excel("2006-2012-math-test-results-school-gender-1.xlsx")
# Rename Columns
colnames(data)[6] <- "Averagescore"
colnames(data)[7] <- "Prof_Level1"
colnames(data)[9] <- "Prof_Level2"
colnames(data)[11] <- "Prof_Level3"
# Clean Averagescore (convert to numeric but keep all data)
data <- data %>%
>>>>>>> 67e643bb6a598a5bbcdae7bdb44b53f8881da7c1
mutate(
Averagescore = ifelse(Averagescore == "s", NA, Averagescore),
Averagescore = as.numeric(Averagescore)
)
# Convert Year to factor
<<<<<<< HEAD
X2006_2012_math_test_results_school_gender_1$Year <-
as.factor(X2006_2012_math_test_results_school_gender_1$Year)
# Filter only Male & Female rows
data_gender <- data %>%
filter(Demographic %in% c("Male", "Female")) %>%
select(Year, Demographic, Mean_Scale_Score)
# Summary statistics by Year and Demographic
summary_gender <- data_gender %>%
group_by(Year, Demographic) %>%
summarise(mean_score = mean(Mean_Scale_Score, na.rm = TRUE),
.groups = 'drop')
print(summary_gender)
# Histogram for Male students
ggplot(data_gender %>% filter(Demographic == "Male"),
aes(x = Mean_Scale_Score)) +
geom_histogram(binwidth = 10, fill = "blue", color = "black") +
facet_wrap(~Year) +
labs(title = "Histogram of Mean Scale Score for Male Students",
x = "Mean Scale Score", y = "Count") +
theme_minimal()
# Histogram for Female students
ggplot(data_gender %>% filter(Demographic == "Female"),
aes(x = Mean_Scale_Score)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
facet_wrap(~Year) +
labs(title = "Histogram of Mean Scale Score for Female Students",
x = "Mean Scale Score", y = "Count") +
theme_minimal()
# Bar plot
ggplot(summary_gender, aes(x = Year, y = mean_score, fill = Demographic)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Year-wise Comparison of Mean Scale Score by Gender",
x = "Year", y = "Mean Scale Score") +
theme_minimal()
# Statistical testing
print("R code for t-test:")
print("t.test(Averagescore ~ Demographic, data = data_clean, var.equal = equal_var)")
var_test <- var.test(Averagescore ~ Demographic, data = data_clean)
equal_var <- var_test$p.value > 0.05
t_test_result <- t.test(Averagescore ~ Demographic, data = data_clean, var.equal = equal_var)
=======
data$Year <- as.factor(data$Year)
# Filter Male/Female ONLY (no column deletion)
data_gender <- data %>%
filter(Demographic %in% c("Male", "Female"))
# Summary statistics (Mean of Averagescore)
summary_gender <- data_gender %>%
group_by(Year, Demographic) %>%
summarise(mean_score = mean(Averagescore, na.rm = TRUE), .groups = 'drop')
print("Yearly Summary Statistics:")
print(summary_gender)
# Filter for non-NA values for visualization and testing
data_gender_clean <- data_gender %>%
filter(!is.na(Averagescore)) %>%
select(Year, Demographic, Averagescore)
plot_hist_with_normal <- function(df, binwidth = 10, ymax = 1000) {
stats <- df %>%
group_by(Demographic) %>%
summarise(mean_score = mean(Averagescore),
sd_score = sd(Averagescore),
n = n(),
.groups = 'drop')
# Prepare normal curve scaled to frequency
curve_data <- do.call(rbind, lapply(1:nrow(stats), function(i) {
x_vals <- seq(min(df$Averagescore), max(df$Averagescore), length.out = 100)
y_vals <- dnorm(x_vals, mean = stats$mean_score[i], sd = stats$sd_score[i])
y_vals <- y_vals * stats$n[i] * binwidth
data.frame(x = x_vals, y = y_vals, Demographic = stats$Demographic[i])
}))
ggplot(df, aes(x = Averagescore)) +
geom_histogram(aes(y = ..count..), binwidth = binwidth, fill = "lightblue", color = "black", alpha = 0.6) +
geom_line(data = curve_data, aes(x = x, y = y), color = "red", size = 1) +
facet_wrap(~Demographic) +
labs(title = "Histogram of Average Scores with Normal Curve (2006–2012)",
x = "Average Score",
y = "Frequency") +
ylim(0, ymax) +
theme_minimal()
}
# Generate histogram
hist_plot <- plot_hist_with_normal(data_gender_clean, binwidth = 10, ymax = 7000)
print(hist_plot)
box_plot <- ggplot(data_gender_clean, aes(x = Demographic, y = Averagescore, fill = Demographic)) +
geom_boxplot() +
scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Boxplot: Mathematics Scores by Gender",
x = "Gender",
y = "Score (points)") +
theme_minimal()
print(box_plot)
print("===========================================")
print("STATISTICAL ANALYSIS RESULTS")
print("===========================================")
# 1. R CODE SNIPPET
print("R code used:")
print("t.test(Averagescore ~ Demographic, data = data_gender_clean, var.equal = equal_var)")
# 2. CHECK VARIANCE & PERFORM t-TEST
var_test <- var.test(Averagescore ~ Demographic, data = data_gender_clean)
equal_var <- var_test$p.value > 0.05
t_test_result <- t.test(Averagescore ~ Demographic,
data = data_gender_clean,
var.equal = equal_var)
# 3. EXTRACT KEY RESULTS
t_statistic <- t_test_result$statistic
p_value <- t_test_result$p.value
# 4. OUTPUT REQUIRED RESULTS
print(paste("Test statistic (t):", round(t_statistic, 4)))
print(paste("p-value:", format(p_value, scientific = TRUE, digits = 4)))
print("")
if(p_value < 0.05) {
print("p-value < 0.05")
print("Result: Statistically significant")
print("Decision: Reject the null hypothesis")
} else {
print("p-value > 0.05")
print("Result: Not statistically significant")
print("Decision: Fail to reject the null hypothesis")
}
print("")
print("=== DESCRIPTIVE STATISTICS (For Report Writing) ===")
desc_stats <- data_gender_clean %>%
group_by(Demographic) %>%
summarise(
n = n(),
mean = mean(Averagescore),
sd = sd(Averagescore),
median = median(Averagescore),
min = min(Averagescore),
max = max(Averagescore),
.groups = 'drop'
)
print(desc_stats)
print("")
print("Mean difference and confidence interval:")
mean_male <- desc_stats$mean[desc_stats$Demographic == "Male"]
mean_female <- desc_stats$mean[desc_stats$Demographic == "Female"]
mean_diff <- mean_male - mean_female
print(paste("Mean difference (Male - Female):", round(mean_diff, 2)))
print(paste("95% Confidence Interval: [",
round(t_test_result$conf.int[1], 2), ", ",
round(t_test_result$conf.int[2], 2), "]"))
print("")
print("Analysis completed successfully.")
# Load required libraries
library(readxl)
library(dplyr)
library(ggplot2)
# Load your Excel file
data <- read_excel("2006-2012-math-test-results-school-gender-1.xlsx")
# Rename Columns
colnames(data)[6] <- "Averagescore"
colnames(data)[7] <- "Prof_Level1"
colnames(data)[9] <- "Prof_Level2"
colnames(data)[11] <- "Prof_Level3"
# Clean Averagescore (convert to numeric but keep all data)
data <- data %>%
mutate(
Averagescore = ifelse(Averagescore == "s", NA, Averagescore),
Averagescore = as.numeric(Averagescore)
)
# Convert Year to factor
data$Year <- as.factor(data$Year)
# Filter Male/Female ONLY (no column deletion)
data_gender <- data %>%
filter(Demographic %in% c("Male", "Female"))
# Summary statistics (Mean of Averagescore)
summary_gender <- data_gender %>%
group_by(Year, Demographic) %>%
summarise(mean_score = mean(Averagescore, na.rm = TRUE), .groups = 'drop')
print("Yearly Summary Statistics:")
print(summary_gender)
# Filter for non-NA values for visualization and testing
data_gender_clean <- data_gender %>%
filter(!is.na(Averagescore)) %>%
select(Year, Demographic, Averagescore)
plot_hist_with_normal <- function(df, binwidth = 10, ymax = 1000) {
stats <- df %>%
group_by(Demographic) %>%
summarise(mean_score = mean(Averagescore),
sd_score = sd(Averagescore),
n = n(),
.groups = 'drop')
# Prepare normal curve scaled to frequency
curve_data <- do.call(rbind, lapply(1:nrow(stats), function(i) {
x_vals <- seq(min(df$Averagescore), max(df$Averagescore), length.out = 100)
y_vals <- dnorm(x_vals, mean = stats$mean_score[i], sd = stats$sd_score[i])
y_vals <- y_vals * stats$n[i] * binwidth
data.frame(x = x_vals, y = y_vals, Demographic = stats$Demographic[i])
}))
ggplot(df, aes(x = Averagescore)) +
geom_histogram(aes(y = ..count..), binwidth = binwidth, fill = "lightblue", color = "black", alpha = 0.6) +
geom_line(data = curve_data, aes(x = x, y = y), color = "red", size = 1) +
facet_wrap(~Demographic) +
labs(title = "Histogram of Average Scores with Normal Curve (2006–2012)",
x = "Average Score",
y = "Frequency") +
ylim(0, ymax) +
theme_minimal()
}
# Generate histogram
hist_plot <- plot_hist_with_normal(data_gender_clean, binwidth = 10, ymax = 7000)
print(hist_plot)
box_plot <- ggplot(data_gender_clean, aes(x = Demographic, y = Averagescore, fill = Demographic)) +
geom_boxplot() +
scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Distribution of Mathematics Scores by Gender (2006-2012)",
x = "Demographic",
y = "Averagescore") +
theme_minimal()
print(box_plot)
print("STATISTICAL ANALYSIS RESULTS")
# 1. R CODE SNIPPET
print("R code used:")
print("t.test(Averagescore ~ Demographic, data = data_gender_clean, var.equal = equal_var)")
# 2. CHECK VARIANCE & PERFORM t-TEST
var_test <- var.test(Averagescore ~ Demographic, data = data_gender_clean)
equal_var <- var_test$p.value > 0.05
t_test_result <- t.test(Averagescore ~ Demographic,
data = data_gender_clean,
var.equal = equal_var)
# 3. EXTRACT KEY RESULTS
t_statistic <- t_test_result$statistic
p_value <- t_test_result$p.value
# 4. OUTPUT REQUIRED RESULTS
print(paste("Test statistic (t):", round(t_statistic, 4)))
print(paste("p-value:", format(p_value, scientific = TRUE, digits = 4)))
print("")
if(p_value < 0.05) {
print("p-value < 0.05")
print("Result: Statistically significant")
print("Decision: Reject the null hypothesis")
} else {
print("p-value > 0.05")
print("Result: Not statistically significant")
print("Decision: Fail to reject the null hypothesis")
}
print("")
# Load required libraries
library(readxl)
library(dplyr)
library(ggplot2)
# Load and prepare data
data <- read_excel("2006-2012-math-test-results-school-gender-1.xlsx")
colnames(data)[6] <- "AverageScore"
colnames(data)[7] <- "Prof_Level1"
colnames(data)[9] <- "Prof_Level2"
colnames(data)[11] <- "Prof_Level3"
data <- data %>%
mutate(
AverageScore = ifelse(AverageScore == "s", NA, AverageScore),
AverageScore = as.numeric(AverageScore)
)
data$Year <- as.factor(data$Year)
data_gender <- data %>% filter(Demographic %in% c("Male", "Female"))
# Clean data for analysis
data_clean <- data_gender %>%
filter(!is.na(AverageScore)) %>%
select(Year, Demographic, AverageScore)
# Visualization 1: Histogram with normal curve
histogram_function <- function(df, binwidth = 10, ymax = 1000) {
stats <- df %>% group_by(Demographic) %>%
summarise(mean_score = mean(AverageScore),
sd_score = sd(AverageScore),
n = n(),
.groups = 'drop')
curve_data <- do.call(rbind, lapply(1:nrow(stats), function(i) {
x_vals <- seq(min(df$AverageScore), max(df$AverageScore), length.out = 100)
y_vals <- dnorm(x_vals, mean = stats$mean_score[i], sd = stats$sd_score[i])
y_vals <- y_vals * stats$n[i] * binwidth
data.frame(x = x_vals, y = y_vals, Demographic = stats$Demographic[i])
}))
ggplot(df, aes(x = AverageScore)) +
geom_histogram(aes(y = ..count..), binwidth = binwidth,
fill = "lightblue", color = "black", alpha = 0.6) +
geom_line(data = curve_data, aes(x = x, y = y), color = "red", size = 1) +
facet_wrap(~Demographic) +
labs(title = "Histogram of Average Scores with Normal Curve (2006–2012)",
x = "Average Score", y = "Frequency") +
ylim(0, ymax) + theme_minimal()
}
print(histogram_function(data_clean, binwidth = 10, ymax = 7000))
# Visualization 2: Boxplot
boxplot_plot <- ggplot(data_clean, aes(x = Demographic, y = AverageScore, fill = Demographic)) +
geom_boxplot() + scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Boxplot: Mathematics Scores by Gender",
x = "Gender", y = "Score (points)") + theme_minimal()
print(boxplot_plot)
# Statistical testing
print("R code for t-test:")
print("t.test(AverageScore ~ Demographic, data = data_clean, var.equal = equal_var)")
var_test <- var.test(AverageScore ~ Demographic, data = data_clean)
equal_var <- var_test$p.value > 0.05
t_test_result <- t.test(AverageScore ~ Demographic, data = data_clean, var.equal = equal_var)
>>>>>>> 67e643bb6a598a5bbcdae7bdb44b53f8881da7c1
print(paste("Test statistic (t):", round(t_test_result$statistic, 4)))
print(paste("p-value:", format(t_test_result$p.value, scientific = TRUE, digits = 4)))
if(t_test_result$p.value < 0.05) {
print("p-value < 0.05")
print("Result: Statistically significant")
print("Decision: Reject the null hypothesis")
} else {
print("p-value > 0.05")
print("Result: Not statistically significant")
<<<<<<< HEAD
print("Decision: Fail to reject the null hypothesis")
}
# Histogram for Female students
ggplot(data_gender %>% filter(Demographic == "Female"),
aes(x = Mean_Scale_Score)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
facet_wrap(~Year) +
labs(title = "Histogram of Mean Scale Score for Female Students",
x = "Mean Scale Score", y = "Count") +
theme_minimal()
# Bar plot
ggplot(summary_gender, aes(x = Year, y = mean_score, fill = Demographic)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Year-wise Comparison of Mean Scale Score by Gender",
x = "Year", y = "Mean Scale Score") +
theme_minimal()
=======
print("Decision: Fail to reject the null hypothesis")
}
# Load required libraries
library(readxl)
library(dplyr)
library(ggplot2)
# Load and prepare data
data <- read_excel("2006-2012-math-test-results-school-gender-1.xlsx")
colnames(data)[6] <- "AverageScore"
colnames(data)[7] <- "Prof_Level1"
colnames(data)[9] <- "Prof_Level2"
colnames(data)[11] <- "Prof_Level3"
data <- data %>%
mutate(
AverageScore = ifelse(AverageScore == "s", NA, AverageScore),
AverageScore = as.numeric(AverageScore)
)
data$Year <- as.factor(data$Year)
data_gender <- data %>% filter(Demographic %in% c("Male", "Female"))
# Clean data for analysis
data_clean <- data_gender %>%
filter(!is.na(AverageScore)) %>%
select(Year, Demographic, AverageScore)
# Visualization 1: Histogram with normal curve
histogram_function <- function(df, binwidth = 10, ymax = 1000) {
stats <- df %>% group_by(Demographic) %>%
summarise(mean_score = mean(AverageScore),
sd_score = sd(AverageScore),
n = n(),
.groups = 'drop')
curve_data <- do.call(rbind, lapply(1:nrow(stats), function(i) {
x_vals <- seq(min(df$AverageScore), max(df$AverageScore), length.out = 100)
y_vals <- dnorm(x_vals, mean = stats$mean_score[i], sd = stats$sd_score[i])
y_vals <- y_vals * stats$n[i] * binwidth
data.frame(x = x_vals, y = y_vals, Demographic = stats$Demographic[i])
}))
ggplot(df, aes(x = AverageScore)) +
geom_histogram(aes(y = ..count..), binwidth = binwidth,
fill = "lightblue", color = "black", alpha = 0.6) +
geom_line(data = curve_data, aes(x = x, y = y), color = "red", size = 1) +
facet_wrap(~Demographic) +
labs(title = "Histogram of Average Scores with Normal Curve (2006–2012)",
x = "Average Score", y = "Frequency") +
ylim(0, ymax) + theme_minimal()
}
print(histogram_function(data_clean, binwidth = 10, ymax = 7000))
# Visualization 2: Boxplot
boxplot_plot <- ggplot(data_clean, aes(x = Demographic, y = AverageScore, fill = Demographic)) +
geom_boxplot() + scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Boxplot: Distribution of Mathematics Scores by Gender (2006-2012)",
x = "Gender", y = "Score (points)") + theme_minimal()
print(boxplot_plot)
# Visualization 2: Boxplot
boxplot_plot <- ggplot(data_clean, aes(x = Demographic, y = AverageScore, fill = Demographic)) +
geom_boxplot() + scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Boxplot: Distribution of Mathematics Scores by Gender (2006-2012)",
x = "Demographic", y = "Average Score") + theme_minimal()
print(boxplot_plot)
>>>>>>> 67e643bb6a598a5bbcdae7bdb44b53f8881da7c1
library(readxl)
X2006_2012_math_test_results_school_gender_1_1_ <- read_excel("2006-2012-math-test-results-school-gender-1 (1).xlsx")
View(X2006_2012_math_test_results_school_gender_1_1_)
#✔ Load libraries and dataset
library(readxl)
library(dplyr)
library(ggplot2)
# Load your Excel file
data <- read_excel("2006-2012-math-test-results-school-gender-1 (1).xlsx")
#✔ Rename Columns (Your Required Column Renaming)
colnames(data)[6]  <- "Averagescore"
colnames(data)[7]  <- "Prof_Level1"
colnames(data)[9]  <- "Prof_Level2"
colnames(data)[11] <- "Prof_Level3"
#✔ Clean Averagescore (convert to numeric but keep all data)
data <- data %>%
mutate(
Averagescore = ifelse(Averagescore == "s", NA, Averagescore),
Averagescore = as.numeric(Averagescore)
)
#✔ Convert Year to factor
data$Year <- as.factor(data$Year)
#✔ Filter Male/Female ONLY (no column deletion)
data_gender <- data %>%
filter(Demographic %in% c("Male", "Female"))
#✔ Summary statistics (Mean of Averagescore)
summary_gender <- data_gender %>%
group_by(Year, Demographic) %>%
summarise(mean_score = mean(Averagescore, na.rm = TRUE),
.groups = 'drop')
print(summary_gender)
#✔ Load libraries and dataset
library(readxl)
library(dplyr)
library(ggplot2)
# Load your Excel file
data <- read_excel("2006-2012-math-test-results-school-gender-1 (1).xlsx")
#✔ Rename Columns (Your Required Column Renaming)
colnames(data)[6]  <- "Averagescore"
colnames(data)[7]  <- "Prof_Level1"
colnames(data)[9]  <- "Prof_Level2"
colnames(data)[11] <- "Prof_Level3"
#✔ Clean Averagescore (convert to numeric but keep all data)
data <- data %>%
mutate(
Averagescore = ifelse(Averagescore == "s", NA, Averagescore),
Averagescore = as.numeric(Averagescore)
)
#✔ Convert Year to factor
data$Year <- as.factor(data$Year)
#✔ Filter Male/Female ONLY (no column deletion)
data_gender <- data %>%
filter(Demographic %in% c("Male", "Female"))
#✔ Summary statistics (Mean of Averagescore)
summary_gender <- data_gender %>%
group_by(Year, Demographic) %>%
summarise(mean_score = mean(Averagescore, na.rm = TRUE),
.groups = 'drop')
print(summary_gender)
# Clean data for analysis
data_clean <- data_gender %>%
filter(!is.na(Averagescore)) %>%
select(Year, Demographic, Averagescore)
# Visualization 1: Histogram with normal curve
histogram_function <- function(df, binwidth = 10, ymax = 1000) {
stats <- df %>% group_by(Demographic) %>%
summarise(mean_score = mean(Averagescore),
sd_score = sd(Averagescore),
n = n(),
.groups = 'drop')
curve_data <- do.call(rbind, lapply(1:nrow(stats), function(i) {
x_vals <- seq(min(df$Averagescore), max(df$Averagescore), length.out = 100)
y_vals <- dnorm(x_vals, mean = stats$mean_score[i], sd = stats$sd_score[i])
y_vals <- y_vals * stats$n[i] * binwidth
data.frame(x = x_vals, y = y_vals, Demographic = stats$Demographic[i])
}))
ggplot(df, aes(x = Averagescore)) +
geom_histogram(aes(y = ..count..), binwidth = binwidth,
fill = "lightblue", color = "black", alpha = 0.6) +
geom_line(data = curve_data, aes(x = x, y = y), color = "red", size = 1) +
facet_wrap(~Demographic) +
labs(title = "Histogram of Average Scores with Normal Curve (2006–2012)",
x = "Average Score", y = "Frequency") +
ylim(0, ymax) + theme_minimal()
}
print(histogram_function(data_clean, binwidth = 10, ymax = 7000))
# Visualization 2: Boxplot
boxplot_plot <- ggplot(data_clean, aes(x = Demographic, y = Averagescore, fill = Demographic)) +
geom_boxplot() + scale_fill_manual(values = c("Male" = "blue", "Female" = "pink")) +
labs(title = "Boxplot: Distribution of Mathematics Scores by Gender (2006-2012)",
x = "Demographic", y = "Average Score") + theme_minimal()
print(boxplot_plot)
# Statistical testing
print("R code for t-test:")
print("t.test(Averagescore ~ Demographic, data = data_clean, var.equal = equal_var)")
var_test <- var.test(Averagescore ~ Demographic, data = data_clean)
equal_var <- var_test$p.value > 0.05
t_test_result <- t.test(Averagescore ~ Demographic, data = data_clean, var.equal = equal_var)
print(paste("Test statistic (t):", round(t_test_result$statistic, 4)))
print(paste("p-value:", format(t_test_result$p.value, scientific = TRUE, digits = 4)))
if(t_test_result$p.value < 0.05) {
print("p-value < 0.05")
print("Result: Statistically significant")
print("Decision: Reject the null hypothesis")
} else {
print("p-value > 0.05")
print("Result: Not statistically significant")
print("Decision: Fail to reject the null hypothesis")
}
